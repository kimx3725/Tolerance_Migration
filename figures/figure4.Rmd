---
title: "Untitled"
author: "Dennis"
date: "7/8/2020"
output: html_document
---

# potential fig.3: histogram

Gamma B = c(0.2,0.4,0.6,0.8,1.0) given Gamma A = 0.2, alpha =0.3, cT = 0.7, cM = 0.2 constant 

GammaA  GammaB    M            R
0.2     1.0     0.81372135 0.1862786457
0.2     0.9     0.77379835 0.2262016510
0.2     0.8     0.72962299 0.2703770064
0.2     0.7     0.68081624 0.3191837605
0.2     0.6     0.62689303 0.3731069744
0.2     0.5     0.56726678 0.4327332202
0.2     0.4     0.50123885 0.4987611539
0.2     0.3     0.42797866 0.5720213356
0.2     0.2     0.34649726 0.6535027447
0.2     0.1     0.25562349 0.7443765086
0.2     0.0     0.15415552 0.8458444833

```{r}
# data wranggling
pacman::p_load(dplyr)

M <- c(0.34649726, 0.50123885, 0.62689303, 0.72962299, 0.81372135)

R <- c(0.6535027447, 0.4987611539, 0.3731069744, 0.2703770064, 0.1862786457)
  
df_gamma <- data.frame(M,R)
gdf <- stack(df_gamma) # stack the data
gdf$GammaB <- c(0.2,0.4,0.6,0.8,1.0,0.2,0.4,0.6,0.8,1.0)
gdf
```

```{r}
# ggplot 
pacman::p_load(ggplot2,gridExtra,reshape2,envalysis)
theme_set(theme_publish())  
fig4 <- ggplot(gdf,aes(x=GammaB,y=values,fill = ind)) + geom_col(position = "dodge",colour= "black") + ylim(c(0,1)) + labs(y="Fraction of partially migratory population",x="Gamma B") + scale_x_continuous(expression(paste("Recovery rate in environment B",~(gamma[B]))),labels=as.character(gdf$GammaB),breaks=gdf$GammaB) + scale_fill_manual(name="Groups",breaks=c("M","R"),labels=c("Migrant","Resident"),values= c("#f7fcb9","#31a354"))
fig4
ggsave("fig4.png",width = 8, height = 5)
```

